From af22dcb71b3de45a2451b958636c08c2d1e28503 Mon Sep 17 00:00:00 2001
From: Paul Spooren <mail@aparcar.org>
Date: Wed, 8 Dec 2021 12:06:48 -1000
Subject: [PATCH 2/2] post-install: don't chroot

chrooting into a different architecture doesn't make sense

Signed-off-by: Paul Spooren <mail@aparcar.org>
---
 src/database.c | 5 -----
 1 file changed, 5 deletions(-)

diff --git a/src/database.c b/src/database.c
index 5570977..d83fb7b 100644
--- a/src/database.c
+++ b/src/database.c
@@ -1888,11 +1888,6 @@ int apk_db_run_script(struct apk_database *db, char *fn, char **argv)
 			exit(127);
 		}
 
-		if (!(db->ctx->flags & APK_NO_CHROOT) && chroot(".") != 0) {
-			apk_err(out, "%s: chroot: %s", basename(fn), strerror(errno));
-			exit(127);
-		}
-
 		extern char **environ;
 		execve(fn, argv, environ);
 		exit(127); /* should not get here */
-- 
2.30.2

