diff --git a/src/adb.h b/src/adb.h
index 183c5f0..4911b97 100644
--- a/src/adb.h
+++ b/src/adb.h
@@ -122,13 +122,19 @@ struct adb_sign_v0 {
 #define ADB_KIND_BLOB	4
 #define ADB_KIND_INT	5
 
-#define ADB_ARRAY_ITEM(_t) { { .kind = &(_t).kind } }
+#define ADB_ARRAY_ITEM(_t) (const struct adb_object_schema_field[1]) { {.kind = &(_t).kind} }
+#define ADB_OBJECT_ITEMS(n) (const struct adb_object_schema_field[n])
 #define ADB_FIELD(_i, _n, _t) [(_i)-1] = { .name = _n, .kind = &(_t).kind }
 
 #define ADB_OBJCMP_EXACT	0	// match all fields
 #define ADB_OBJCMP_TEMPLATE	1	// match fields set on template
 #define ADB_OBJCMP_INDEX	2	// match fields until first non-set one
 
+struct adb_object_schema_field {
+	const char *name;
+	const uint8_t *kind;
+};
+
 struct adb_object_schema {
 	uint8_t kind;
 	uint16_t num_fields;
@@ -137,11 +143,7 @@ struct adb_object_schema {
 	apk_blob_t (*tostring)(struct adb_obj *, char *, size_t);
 	int (*fromstring)(struct adb_obj *, apk_blob_t);
 	void (*pre_commit)(struct adb_obj *);
-
-	struct {
-		const char *name;
-		const uint8_t *kind;
-	} fields[];
+	const struct adb_object_schema_field *fields;
 };
 
 struct adb_scalar_schema {
diff --git a/src/apk_adb.c b/src/apk_adb.c
index c497f0c..37d9cfd 100644
--- a/src/apk_adb.c
+++ b/src/apk_adb.c
@@ -359,7 +359,7 @@ const struct adb_object_schema schema_dependency = {
 	.num_compare = ADBI_DEP_NAME,
 	.tostring = dependency_tostring,
 	.fromstring = dependency_fromstring,
-	.fields = {
+	.fields = ADB_OBJECT_ITEMS(ADBI_DEP_MAX) {
 		ADB_FIELD(ADBI_DEP_NAME,	"name",		scalar_string),
 		ADB_FIELD(ADBI_DEP_VERSION,	"version",	scalar_version),
 		ADB_FIELD(ADBI_DEP_MATCH,	"match",	scalar_int),
@@ -394,7 +394,7 @@ const struct adb_object_schema schema_pkginfo = {
 	.kind = ADB_KIND_OBJECT,
 	.num_fields = ADBI_PI_MAX,
 	.num_compare = ADBI_PI_UNIQUE_ID,
-	.fields = {
+	.fields = ADB_OBJECT_ITEMS(ADBI_PI_MAX) {
 		ADB_FIELD(ADBI_PI_NAME,		"name",		scalar_name),
 		ADB_FIELD(ADBI_PI_VERSION,	"version",	scalar_version),
 		ADB_FIELD(ADBI_PI_UNIQUE_ID,	"unique-id",	scalar_hexblob),
@@ -428,7 +428,7 @@ const struct adb_object_schema schema_pkginfo_array = {
 const struct adb_object_schema schema_index = {
 	.kind = ADB_KIND_OBJECT,
 	.num_fields = ADBI_NDX_MAX,
-	.fields = {
+	.fields = ADB_OBJECT_ITEMS(ADBI_NDX_MAX) {
 		ADB_FIELD(ADBI_NDX_DESCRIPTION,	"description",	scalar_string),
 		ADB_FIELD(ADBI_NDX_PACKAGES,	"packages",	schema_pkginfo_array),
 	},
@@ -437,7 +437,7 @@ const struct adb_object_schema schema_index = {
 const struct adb_object_schema schema_acl = {
 	.kind = ADB_KIND_OBJECT,
 	.num_fields = ADBI_ACL_MAX,
-	.fields = {
+	.fields = ADB_OBJECT_ITEMS(ADBI_ACL_MAX) {
 		ADB_FIELD(ADBI_ACL_MODE,	"mode",		scalar_oct),
 		ADB_FIELD(ADBI_ACL_USER,	"user",		scalar_string),
 		ADB_FIELD(ADBI_ACL_GROUP,	"group",	scalar_string),
@@ -449,7 +449,7 @@ const struct adb_object_schema schema_file = {
 	.kind = ADB_KIND_OBJECT,
 	.num_fields = ADBI_FI_MAX,
 	.num_compare = ADBI_FI_NAME,
-	.fields = {
+	.fields = ADB_OBJECT_ITEMS(ADBI_FI_MAX) {
 		ADB_FIELD(ADBI_FI_NAME,		"name",		scalar_string),
 		ADB_FIELD(ADBI_FI_ACL,		"acl",		schema_acl),
 		ADB_FIELD(ADBI_FI_SIZE,		"size",		scalar_int),
@@ -470,7 +470,7 @@ const struct adb_object_schema schema_dir = {
 	.kind = ADB_KIND_OBJECT,
 	.num_fields = ADBI_DI_MAX,
 	.num_compare = ADBI_DI_NAME,
-	.fields = {
+	.fields = ADB_OBJECT_ITEMS(ADBI_DI_MAX) {
 		ADB_FIELD(ADBI_DI_NAME,		"name",		scalar_string),
 		ADB_FIELD(ADBI_DI_ACL,		"acl",		schema_acl),
 		ADB_FIELD(ADBI_DI_FILES,	"files",	schema_file_array),
@@ -487,7 +487,7 @@ const struct adb_object_schema schema_dir_array = {
 const struct adb_object_schema schema_scripts = {
 	.kind = ADB_KIND_OBJECT,
 	.num_fields = ADBI_SCRPT_MAX,
-	.fields = {
+	.fields = ADB_OBJECT_ITEMS(ADBI_SCRPT_MAX) {
 		ADB_FIELD(ADBI_SCRPT_TRIGGER,	"trigger",	scalar_mstring),
 		ADB_FIELD(ADBI_SCRPT_PREINST,	"pre-install",	scalar_mstring),
 		ADB_FIELD(ADBI_SCRPT_POSTINST,	"post-install",	scalar_mstring),
@@ -502,7 +502,7 @@ const struct adb_object_schema schema_package = {
 	.kind = ADB_KIND_OBJECT,
 	.num_fields = ADBI_PKG_MAX,
 	.num_compare = ADBI_PKG_PKGINFO,
-	.fields = {
+	.fields = ADB_OBJECT_ITEMS(ADBI_PKG_MAX) {
 		ADB_FIELD(ADBI_PKG_PKGINFO,	"info",		schema_pkginfo),
 		ADB_FIELD(ADBI_PKG_PATHS,	"paths",	schema_dir_array),
 		ADB_FIELD(ADBI_PKG_SCRIPTS,	"scripts",	schema_scripts),
@@ -527,7 +527,7 @@ const struct adb_object_schema schema_package_adb_array = {
 const struct adb_object_schema schema_idb = {
 	.kind = ADB_KIND_OBJECT,
 	.num_fields = ADBI_IDB_MAX,
-	.fields = {
+	.fields = ADB_OBJECT_ITEMS(ADBI_IDB_MAX) {
 		ADB_FIELD(ADBI_IDB_PACKAGES,	"packages",	schema_package_adb_array),
 	},
 };
